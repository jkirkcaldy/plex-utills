[uwsgi]

chdir = /plex-utils
module = plex_utils.wsgi

uid=www-data
gid=www-data

processes = 20
threads = 2

master = true

socket = 127.0.0.1:5000

vacuum = true

hook-master-start = unix_signal:15 gracefully_kill_them_all
need-app = true
die-on-term = true

http-keepalive = 1
http-auto-gzip = true

offload-threads = 1
check-static = static/
static-gzip-all = true

collect-header = Content-Type RESPONSE_CONTENT_TYPE
response-route-if = equal:${RESPONSE_CONTENT_TYPE};application/json addheader:uWSGI-Encoding: gzip
response-route-if = startswith:${RESPONSE_CONTENT_TYPE};text/html addheader:uWSGI-Encoding: gzip